# Water Academy UI Transfer Guide

## I. Overview & Objectives

This guide outlines the process for migrating the Water Academy Management System's frontend from its current Bootstrap/jQuery implementation to a modern stack utilizing **Tailwind CSS + Alpine.js + Chart.js**. The primary objective is to replace the existing UI framework while preserving all PHP business logic, database interactions, and Role-Based Access Control (RBAC) guards. The expected outcome is a conflict-free, mobile-first, highly maintainable, and performant reporting UI.

## II. New Folder & File Structure

The UI migration will involve a significant reorganization and replacement of frontend assets. The new structure will look as follows:

```
/ (project root)
├─ /dashboards/
│   ├─ group_dashboard.php
│   ├─ trainee_dashboard.php
│   ├─ report_attendance_summary.php
│   └─ … (other PHP pages)
├─ /includes/
│   ├─ auth.php
│   ├─ config.php
│   ├─ header.php
│   ├─ sidebar.php
│   ├─ footer.php
│   └─ components/
│       └─ kpi-card.php
├─ /assets/
│   ├─ /css/
│   │   ├─ tailwind.css     ← generated via build (or CDN reference)
│   │   ├─ custom.css       ← minimal overrides / component styles
│   ├─ /js/
│   │   ├─ alpine.min.js    ← CDN
│   │   ├─ chart.min.js     ← CDN
│   │   └─ app.js           ← Alpine + Chart.js init logic
│   ├─ /vendor/
│   │   └─ /html2pdf/
│   │       └─ html2pdf.bundle.min.js
│   └─ /img/ (logos/icons/backgrounds) ← Renamed from /images/ for consistency with existing structure
├─ /settings/ (email_templates.php, etc.)
├─ /Srcs/ (legacy, unchanged)
├─ /docs/
│   └─ Original_WaterAcademy_System_Documentation.md
└─ README.md (link to both documentation files)
```

**Explanation of Changes:**

*   **Removal of Old Assets**: All original Sneat/Bootstrap CSS files (e.g., `assets/css/core.css`, `assets/css/layout.css`, `assets/css/components/*`, `assets/css/pages/login.css`, and all `assets/css/_old/` files) will be removed. Similarly, all jQuery-dependent JavaScript files (e.g., `assets/js/app.js` (old version), `assets/js/dashboards-analytics.js`, `assets/js/group-performance-report.js`, `assets/js/report-fixes.js`, `assets/js/report-print.js`, `assets/js/cache-management.js`, `assets/js/config.js`, `assets/js/module-fix.js`, `assets/js/sidebar-toggle.js`, `assets/js/switch-role.js`, `assets/js/theme-switcher.js`, `assets/js/wa-modal.js`, `assets/js/wa-table.js`, `assets/js/utils/*`, `assets/js/modules/*`, and all `assets/js/_old/` files) will be removed or replaced.
*   **New CSS**: `assets/css/tailwind.css` will be the primary stylesheet, generated by Tailwind CSS. `assets/css/custom.css` will contain minimal custom styles or overrides.
*   **New JavaScript**: `alpine.min.js` and `chart.min.js` will be loaded via CDN. A new `assets/js/app.js` will serve as the main entry point for Alpine.js and Chart.js initialization logic.
*   **Vendor Files**: The `html2pdf` library will be retained under `assets/vendor/html2pdf/`.
*   **Image Assets**: The `/assets/img/` directory will remain for logos, icons, and backgrounds.
*   **Documentation**: A new `docs/` folder will be created to house documentation, including the original and new transfer guide.

### Tailwind Build Environment

To generate `tailwind.css`, a Node.js environment is required.

1.  **Install Node.js**: If not already installed, download and install Node.js (which includes npm) from [nodejs.org](https://nodejs.org/).
2.  **Initialize npm project**:
    ```bash
    npm init -y
    ```
3.  **Install Tailwind CSS, PostCSS, and Autoprefixer**:
    ```bash
    npm install -D tailwindcss postcss autoprefixer
    ```
4.  **Initialize Tailwind CSS**:
    ```bash
    npx tailwindcss init -p
    ```
    This will create `tailwind.config.js` and `postcss.config.js`.
5.  **Configure `tailwind.config.js`**:
    Update `tailwind.config.js` to include `jit` mode (if using Tailwind v2.x) or ensure `content` paths are correct (for Tailwind v3.x) and extend the theme.

    ```javascript
    // tailwind.config.js
    module.exports = {
      // For Tailwind CSS v3.x
      content: [
        './dashboards/**/*.php',
        './includes/**/*.php',
        './assets/js/**/*.js', // If you have Alpine.js logic in separate JS files
        './login.php',
        './index.html',
      ],
      // For Tailwind CSS v2.x, use 'purge'
      // purge: {
      //   enabled: process.env.NODE_ENV === 'production',
      //   content: [
      //     './dashboards/**/*.php',
      //     './includes/**/*.php',
      //     './assets/js/**/*.js',
      //     './login.php',
      //     './index.html',
      //   ],
      // },
      darkMode: 'class', // or 'media' or 'false'
      theme: {
        extend: {
          colors: {
            'primary-wa': '#0056b3', // Example custom color
            'secondary-wa': '#6c757d',
            // Add more custom colors based on your design system
          },
          fontFamily: {
            sans: ['Public Sans', 'Arial', 'sans-serif'],
            // Add other fonts if needed
          },
          spacing: {
            '72': '18rem',
            '84': '21rem',
            '96': '24rem',
          },
        },
      },
      variants: {
        extend: {},
      },
      plugins: [],
    };
    ```
6.  **Create `assets/css/input.css`**:
    This file will contain the Tailwind directives.

    ```css
    /* assets/css/input.css */
    @tailwind base;
    @tailwind components;
    @tailwind utilities;

    /* Add any global custom styles here if absolutely necessary */
    /* For example, if you need to override a Tailwind default */
    /* .custom-card-shadow {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    } */
    ```
7.  **Add build script to `package.json`**:
    ```json
    {
      "name": "water-academy-visualizer",
      "version": "1.0.0",
      "description": "Water Academy Management System UI Migration",
      "main": "index.js",
      "scripts": {
        "build:css": "tailwindcss -i ./assets/css/input.css -o ./assets/css/tailwind.css --minify",
        "watch:css": "tailwindcss -i ./assets/css/input.css -o ./assets/css/tailwind.css --watch"
      },
      "keywords": [],
      "author": "",
      "license": "ISC",
      "devDependencies": {
        "autoprefixer": "^10.4.19",
        "postcss": "^8.4.38",
        "tailwindcss": "^3.4.3"
      }
    }
    ```
8.  **Run Tailwind build**:
    *   To build the CSS once:
        ```bash
        npm run build:css
        ```
    *   To watch for changes during development:
        ```bash
        npm run watch:css
        ```

## III. Transfer Phases & Steps

The UI migration will be executed in distinct phases, each with clear steps, verification criteria, testing mechanisms, and Git commit guidelines.

### Phase 1: Preparation & Backup

**Objective**: Establish a clean Git branch and back up existing documentation before starting UI modifications.

*   **Step 1.1: Create a new Git branch `feature/tailwind-rebuild`**
    *   **Action**: Create a new Git branch from the current `main` branch (on the remote).
    *   **Command**:
        ```bash
        git checkout main
        git pull origin main
        git checkout -b feature/tailwind-rebuild
        git push -u origin feature/tailwind-rebuild
        ```
    *   **Verification**: Run `git status` locally; it should show "On branch feature/tailwind-rebuild" with no uncommitted changes. Confirm the branch exists on the remote repository.
    *   **Testing**: N/A (Git operation).
    *   **Git Commit**: `chore: create feature/tailwind-rebuild branch for UI migration`

*   **Step 1.2: Make an initial documentation commit on `feature/tailwind-rebuild`**
    *   **Action**: Copy the existing `logs/Water Academy System Documentation.md` into a new directory `docs/` as `docs/Original_WaterAcademy_System_Documentation.md`.
    *   **Command**:
        ```bash
        mkdir docs
        cp logs/Water\ Academy\ System\ Documentation.md docs/Original_WaterAcademy_System_Documentation.md
        git add docs/Original_WaterAcademy_System_Documentation.md
        git commit -m "docs: backup original system documentation before UI migration"
        ```
    *   **Verification**: Ensure `docs/Original_WaterAcademy_System_Documentation.md` exists and its content is identical to the original.
    *   **Testing**: Perform a quick visual check of the file contents.
    *   **Git Commit**: `docs: backup original documentation before UI migration`

### Phase 2: Cleanup of Old Assets & Skeleton Setup

**Objective**: Remove all references to the old Bootstrap/jQuery assets and introduce the new Tailwind/Alpine/Chart.js placeholders.

*   **Step 2.1: Remove old Sneat/Bootstrap CSS and JS references**
    *   **Action**: Systematically remove `<link>` tags for old CSS and `<script>` tags for old JS from `/includes/header.php`, `/includes/footer.php`, and `login.php`. This includes all files listed under "Files to Remove or Ignore" in the augmented `Water Academy System Documentation.md`.
    *   **Example Removal (from `includes/header.php`):**
        ```diff
        --- a/includes/header.php
        +++ b/includes/header.php
        @@ -50,30 +50,6 @@
         <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" />
         <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
        -
        -    <!-- Core CSS (Essential Bootstrap Styles) -->
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/core.css" class="template-customizer-core-css" />
        -
        -    <!-- Custom CSS -->
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/base.css?v=<?php echo time(); ?>" />
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/layout.css?v=<?php echo time(); ?>" />
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/components/cards.css?v=<?php echo time(); ?>" />
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/components/buttons.css?v=<?php echo time(); ?>" />
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/components/dropdowns.css?v=<?php echo time(); ?>" />
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/components/modals.css?v=<?php echo time(); ?>" /> <!-- New Modals CSS -->
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>css/pages/login.css?v=<?php echo time(); ?>" />
        -
        -    <!-- Vendors CSS (only essential ones, perfect-scrollbar.css is problematic) -->
        -    <link rel="stylesheet" href="<?php echo htmlspecialchars($baseAssetPath); ?>vendor/libs/perfect-scrollbar/perfect-scrollbar.css" /> 
        -    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bs-stepper/dist/css/bs-stepper.min.css">
        -    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts@3.45.1/dist/apexcharts.css"> 
        -    
        -    <!-- Custom Font for Welcome Message (Michroma is already in base.css) -->
        -    <!-- <style>
        -      @font-face {
        -        font-family: 'Michroma';
        -        src: url('<?php echo htmlspecialchars($baseAssetPath); ?>fonts/michroma/Michroma.ttf') format('truetype');
        -        font-weight: normal;
        -        font-style: normal;
        -      }
        -    </style> -->
        -
        -    <!-- Base dependencies -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/utils/logger.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/utils/config-manager.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/utils/dependency-manager.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/module-fix.js?v=<?php echo time(); ?>"></script>
        -
        -    <!-- Chart.js for doughnut charts -->
        -    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        -
        -    <!-- ApexCharts JS -->
        -    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.45.1/dist/apexcharts.min.js"></script>
        -
        -    <!-- BS-Stepper JS -->
        -    <script src="https://cdn.jsdelivr.net/npm/bs-stepper/dist/js/bs-stepper.min.js"></script>
        -
        -    <!-- Our Refactored Helpers -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/utils/helpers.js?v=<?php echo time(); ?>"></script>
        -    
        -    <!-- Theme and UI components (after core libraries) -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/theme-switcher.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/sidebar-toggle.js?v=<?php echo time(); ?>"></script>
        -    
        -    <!-- Essential custom JS files (now initialized by app.js) -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/wa-modal.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/utils/modal-upgrade.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/wa-table.js?v=<?php echo time(); ?>"></script>
        -    
        -    <!-- Our Modular JS Files (must be loaded before app.js) -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/modules/ui-components.js?v=<?php echo time(); ?>"></script>
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/modules/layout.js?v=<?php echo time(); ?>"></script>
        -
        -    <!-- Our Main Application JS -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/app.js?v=<?php echo time(); ?>"></script>
        -    
        -    <!-- Cache Management JS -->
        -    <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/cache-management.js?v=<?php echo time(); ?>"></script>
        -
        -    <!-- Removed old/redundant JS files -->
        -    <!-- <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/main.js"></script> -->
        -    <!-- <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/page-transitions.js"></script> -->
        -    <!-- <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/consolidated-dropdown-fix.js"></script> -->
        -    <!-- <script src="<?php echo htmlspecialchars($baseAssetPath); ?>js/modal-handler.js"></script> -->
        -    <!-- <script src="<?php echo htmlspecialchars($baseAssetPath); ?>vendor/js/helpers.js"></script> -->
        -    <!-- <script src="<?php echo htmlspecialchars($baseAssetPath); ?>vendor/js/menu.js"></script> -->
         </head>
         
         <body>
        ```
    *   **Verification**: Run the application locally. All pages should render without the removed CSS/JS files. They will look unstyled or "broken" but should not produce 404 errors for the removed assets.
    *   **Testing**: Open browser DevTools (F12). Go to the Network tab and ensure no 404 errors for the removed CSS/JS files. Check the Console tab for any "$ is not defined" or "Bootstrap is not defined" errors (there should be none related to the removed files).
    *   **Git Commit**: `chore: remove Sneat/Bootstrap asset references and vendor files`

*   **Step 2.2: Add new Tailwind/Alpine/Chart.js placeholders**
    *   **Action**: In `/includes/header.php`, add the new Tailwind CSS link and a placeholder for `custom.css`. At the end of the `<body>` (or in `includes/footer.php` if preferred), add Alpine.js, Chart.js, and the new `app.js` script.
    *   **Example Addition (in `includes/header.php`):**
        ```html
        <!-- Tailwind CSS -->
        <link href="/assets/css/tailwind.css" rel="stylesheet">
        <!-- Custom overrides -->
        <link rel="stylesheet" href="/assets/css/custom.css">
        ```
    *   **Example Addition (at end of `</body>` in `includes/footer.php`):**
        ```html
        <!-- Alpine.js -->
        <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
        <!-- Chart.js -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <!-- App logic -->
        <script src="/assets/js/app.js"></script>
        ```
    *   **Action**: Create empty placeholder files: `assets/css/tailwind.css`, `assets/css/custom.css`, `assets/js/app.js`.
    *   **Verification**: Pages load with no missing-file errors. DevTools Network tab shows `tailwind.css`, `custom.css`, `alpine.min.js`, `chart.js`, and `app.js` loaded successfully.
    *   **Testing**: Load any dashboard page in the browser. The HTML will be unstyled (as Bootstrap is gone and Tailwind hasn't been applied yet), but there should be no console errors related to missing scripts or undefined variables.
    *   **Git Commit**: `feat: add Tailwind, Alpine.js, Chart.js references and custom.css placeholder`

### Phase 3: Core Includes & Componentization

**Objective**: Reimplement the core layout (header, sidebar) and a reusable KPI card component using Tailwind CSS and Alpine.js.

*   **Step 3.1: Create `/includes/header.php` in Tailwind style**
    *   **Action**: Rewrite the content of `includes/header.php` to use Tailwind classes and Alpine.js for interactive elements (like a mobile hamburger menu). Ensure PHP variables for user info and permissions are preserved.
    *   **Example Structure (simplified):**
        ```php
        <?php
        // ... existing PHP logic for $pageTitle, $userName, $userRole, $avatarPath, isLoggedIn(), hasPermission() ...
        ?>
        <!DOCTYPE html>
        <html lang="en" class="h-full bg-gray-100">
        <head>
            <meta charset="utf-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
            <title><?= htmlspecialchars($pageTitle); ?> | Water Academy</title>
            <!-- Favicon, Fonts, Icons CSS (keep existing CDN links) -->
            <link rel="icon" type="image/x-icon" href="<?= htmlspecialchars($baseAssetPath); ?>img/favicon/favicon.ico" />
            <link rel="preconnect" href="https://fonts.googleapis.com" />
            <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
            <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet" />
            <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" />
            <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

            <!-- Tailwind CSS -->
            <link href="/assets/css/tailwind.css" rel="stylesheet">
            <!-- Custom overrides -->
            <link rel="stylesheet" href="/assets/css/custom.css">
        </head>
        <body class="font-sans antialiased">
            <div class="min-h-screen bg-gray-100" x-data="{ sidebarOpen: window.innerWidth >= 768 }">
                <!-- Header -->
                <header class="flex items-center justify-between bg-white border-b border-gray-200 px-4 py-3 md:px-6 md:py-4 shadow-sm">
                    <div class="flex items-center">
                        <!-- Hamburger button for mobile -->
                        <button @click="sidebarOpen = !sidebarOpen" class="md:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </button>
                        <!-- Logo -->
                        <a href="index.php" class="flex items-center ml-4 md:ml-0">
                            <img src="<?= htmlspecialchars($baseAssetPath); ?>img/logos/waLogoBlue.png" alt="Water Academy Logo" class="h-10 w-auto">
                            <span class="ml-2 text-xl font-semibold text-gray-800">Water Academy</span>
                        </a>
                    </div>

                    <!-- User menu and theme toggle -->
                    <div class="flex items-center space-x-4">
                        <!-- Theme toggle button (reimplement with Alpine if needed) -->
                        <button id="theme-toggle-btn" class="p-2 rounded-full text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                            <i class="bx bx-sun theme-icon-light"></i>
                            <i class="bx bx-moon theme-icon-dark d-none"></i>
                        </button>

                        <?php if (isLoggedIn()): ?>
                        <div class="relative" x-data="{ open: false }" @click.away="open = false">
                            <button @click="open = !open" class="flex items-center space-x-2 focus:outline-none">
                                <img class="h-8 w-8 rounded-full object-cover" src="<?= htmlspecialchars($avatarPath); ?>" alt="User Avatar">
                                <span class="text-sm font-medium text-gray-700 hidden md:block"><?= htmlspecialchars($userName); ?></span>
                                <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </button>
                            <div x-show="open" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95" class="absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 z-50">
                                <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/profile.php" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">My Profile</a>
                                <?php if (hasPermission('manage_system_settings')): ?>
                                <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/settings.php" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                                <?php endif; ?>
                                <?php if (hasPermission('manage_roles')): ?>
                                <a href="javascript:void(0);" @click="WA_Modal.show('switchRoleModal')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Switch Role</a>
                                <?php endif; ?>
                                <a href="<?= htmlspecialchars($baseLinkPath); ?>logout.php" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Log Out</a>
                            </div>
                        </div>
                        <?php endif; ?>
                    </div>
                </header>
                <!-- Main content area (for pages to fill) -->
                <div class="flex">
                    <!-- Sidebar will be included here -->
        ```
    *   **Verification**: Load a dashboard page in the browser. The header should appear with the logo, hamburger menu (on small screens), and a basic user menu. The layout will still be unstyled beyond the header.
    *   **Testing**:
        *   In DevTools, inspect the `<body>` element—ensure it has `x-data="{ sidebarOpen: window.innerWidth >= 768 }"` or similar Alpine data attribute.
        *   Resize the browser window: the hamburger menu should appear/disappear at the `md` breakpoint.
        *   Click the hamburger menu (if visible); no errors should appear in the console.
    *   **Git Commit**: `feat: implement Tailwind/Alpine header.php with PHP guards and logo`

*   **Step 3.2: Create `/includes/sidebar.php` in Tailwind style**
    *   **Action**: Rewrite the content of `includes/sidebar.php` to use Tailwind classes and Alpine.js for its toggle behavior. Implement menu items with PHP `hasPermission()` guards.
    *   **Example Structure (simplified):**
        ```php
        <?php
        // ... existing PHP logic for hasPermission() ...
        ?>
        <!-- Sidebar -->
        <aside class="fixed inset-y-0 left-0 w-64 bg-white border-r border-gray-200 shadow-lg transform transition-transform duration-200 md:translate-x-0"
               :class="{ '-translate-x-full': !sidebarOpen }"
               @click.outside="sidebarOpen = false">
            <div class="flex items-center justify-between h-16 px-4 border-b border-gray-200">
                <span class="text-lg font-semibold text-gray-800">Navigation</span>
                <button @click="sidebarOpen = false" class="md:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <nav class="flex-1 px-2 py-4 space-y-1">
                <?php if (hasPermission('access_dashboard')): ?>
                <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/index.php" class="flex items-center px-2 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900">
                    <i class="bx bx-home-alt mr-3 text-lg"></i> Dashboard
                </a>
                <?php endif; ?>
                <?php if (hasPermission('manage_groups')): ?>
                <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/groups.php" class="flex items-center px-2 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900">
                    <i class="bx bx-group mr-3 text-lg"></i> Groups
                </a>
                <?php endif; ?>
                <?php if (hasPermission('record_attendance')): ?>
                <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/attendance.php" class="flex items-center px-2 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900">
                    <i class="bx bx-calendar-check mr-3 text-lg"></i> Attendance
                </a>
                <?php endif; ?>
                <?php if (hasPermission('access_trainee_reports') || hasPermission('access_group_reports')): ?>
                <div x-data="{ open: false }" class="space-y-1">
                    <button @click="open = !open" class="flex items-center w-full px-2 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 focus:outline-none">
                        <i class="bx bx-file-text mr-3 text-lg"></i> Reports
                        <svg :class="{ 'rotate-90': open }" class="ml-auto h-5 w-5 transform transition-transform duration-200" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <div x-show="open" x-transition:enter="transition ease-out duration-100" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="space-y-1 pl-4">
                        <?php if (hasPermission('access_group_reports')): ?>
                        <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/report_group_performance.php" class="flex items-center px-2 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900">
                            Group Performance
                        </a>
                        <?php endif; ?>
                        <?php if (hasPermission('access_trainee_reports')): ?>
                        <a href="<?= htmlspecialchars($baseLinkPath); ?>dashboards/report_trainee_performance.php" class="flex items-center px-2 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900">
                            Trainee Performance
                        </a>
                        <?php endif; ?>
                    </div>
                </div>
                <?php endif; ?>
                <!-- ... other menu items ... -->
            </nav>
        </aside>
        <div class="flex-1 md:ml-64"> <!-- Adjust main content margin for sidebar -->
        ```
    *   **Verification**: Load a dashboard page. The sidebar should appear on desktop. On mobile, clicking the hamburger button in the header should toggle the sidebar visibility. Menu items should be clickable.
    *   **Testing**:
        *   Resize browser to widths <768px: the sidebar should be hidden by default. Clicking the hamburger icon should slide it in. Clicking outside the sidebar should close it.
        *   Log in with different roles (Admin, Instructor, Coordinator) and verify that only the permitted menu items are visible in the sidebar.
    *   **Git Commit**: `feat: implement Tailwind/Alpine sidebar.php with RBAC menu links`

*   **Step 3.3: Create `/includes/components/kpi-card.php`**
    *   **Action**: Create a new file `includes/components/kpi-card.php` that renders a single KPI card with a Chart.js doughnut chart.
    *   **Content for `includes/components/kpi-card.php`:**
        ```php
        <?php
        // Expected variables: $title, $iconClass, $value, $chartId
        // $value should be a number (e.g., 75 for 75%)
        // $chartId should be unique for each canvas
        
        $displayValue = is_numeric($value) ? round($value, 1) : 'N/A';
        $chartData = is_numeric($value) ? [$value, 100 - $value] : [0, 100]; // For doughnut chart
        $chartColor = '';
        if (strpos($iconClass, 'text-primary') !== false) $chartColor = '#696cff'; // Example primary color
        else if (strpos($iconClass, 'text-green-500') !== false) $chartColor = '#22c55e'; // Tailwind green-500
        else if (strpos($iconClass, 'text-yellow-500') !== false) $chartColor = '#eab308'; // Tailwind yellow-500
        else $chartColor = '#8592a3'; // Default secondary
        ?>
        <div class="bg-white rounded-lg shadow p-6 flex items-center space-x-4" x-data="{ chart: null }" x-init="
            chart = new Chart($refs.canvas, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: <?= json_encode($chartData) ?>,
                        backgroundColor: ['<?= $chartColor ?>', '#e2e8f0'], // Use Tailwind gray-200 for background
                        borderWidth: 0,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '80%', // Make it a ring
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        ">
            <div class="flex-shrink-0">
                <i class="<?= htmlspecialchars($iconClass); ?> text-4xl"></i>
            </div>
            <div class="flex-grow">
                <h3 class="text-lg font-semibold text-gray-700"><?= htmlspecialchars($title); ?></h3>
                <p class="text-3xl font-bold text-gray-900"><?= $displayValue ?>%</p>
            </div>
            <div class="w-24 h-24">
                <canvas x-ref="canvas"></canvas>
            </div>
        </div>
        ```
    *   **Verification**: Include this component in a PHP page (e.g., `dashboards/index.php` temporarily) with dummy data.
    *   **Testing**: Render a dummy card by adding the following PHP to `dashboards/index.php` (or any page that includes `header.php`):
        ```php
        <?php
          $title = 'Dummy KPI';
          $iconClass = 'bx bx-chart-pie text-primary-wa'; // Use custom Tailwind color
          $value = 75;
          $chartId = 'chartDummy';
          include __DIR__ . '/../includes/components/kpi-card.php';
        ?>
        ```
        Check in the browser that a card with the title, value, icon, and an empty canvas appears. In the console, ensure no Chart.js or Alpine.js errors.
    *   **Git Commit**: `feat: add Alpine/Chart.js KPI card component partial kpi-card.php`

### Phase 4: Page-by-Page Migration & Testing

**Objective**: Migrate individual dashboard pages to the new Tailwind/Alpine/Chart.js stack, ensuring data display and interactivity are preserved.

*   **Step 4.1: Migrate `dashboards/report_group_performance.php`**
    *   **Action**:
        1.  At the top, ensure `require_once` calls for `auth.php`, `config.php`, and `report_functions.php` are present.
        2.  Include the new `header.php` and `footer.php`.
        3.  Replace the old Bootstrap HTML structure with the new Tailwind/Alpine layout.
        4.  Integrate the `kpi-card.php` component for displaying group metrics.
        5.  Reimplement the groups table using Tailwind CSS classes.
        6.  Ensure Chart.js is initialized for the relevant canvases.
    *   **Example Structure (simplified):**
        ```php
        <?php
        $pageTitle = 'Group Performance Report';
        require_once '../includes/config.php';
        require_once '../includes/auth.php';
        require_permission('access_group_reports', '../login.php'); // RBAC guard
        require_once 'report_functions.php'; // PHP functions to fetch data

        // Assume $groupsData and aggregated metrics are fetched here
        // Example: $groupsData = getGroupPerformanceData($conn, $groupId);
        // $avgScore = calculateAvgMetric($groupsData, 'AvgFinalExamScore');
        // $avgAttendance = calculateAvgMetric($groupsData, 'AvgAttendance');
        // $avgLGI = calculateAvgMetric($groupsData, 'AvgLGI');

        include_once '../includes/header.php';
        ?>

        <div class="ml-0 md:ml-64 transition-all duration-200">
          <main class="p-6 bg-gray-50 min-h-screen">
            <h1 class="text-2xl font-bold text-gray-800 mb-6"><?= htmlspecialchars($pageTitle); ?></h1>

            <!-- KPI Cards Row -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
              <?php
                // Example dummy data for demonstration. Replace with actual PHP variables.
                $avgScore = 85;
                $avgAttendance = 92;
                $avgLGI = 70;

                $cards = [
                  ['Avg Score', 'bx bx-chart-pie text-primary-wa', $avgScore, 'chartAvgScore'],
                  ['Avg Attendance', 'bx bx-calendar-check text-green-500', $avgAttendance, 'chartAvgAttendance'],
                  ['Avg LGI', 'bx bx-line-chart text-yellow-500', $avgLGI, 'chartAvgLGI'],
                ];
                foreach ($cards as $c) {
                  [$title, $iconClass, $value, $chartId] = $c;
                  include __DIR__ . '/../includes/components/kpi-card.php';
                }
              ?>
            </div>

            <!-- Groups Table -->
            <div class="bg-white rounded-lg shadow overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-100">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Group Name</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"># Trainees</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Score</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Attendance</th>
                    <!-- add other columns as needed -->
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  <?php
                  // Example dummy data for demonstration. Replace with actual PHP data from $groupsData.
                  $groups = [
                      ['GroupName' => 'Group Alpha', 'TraineeCount' => 20, 'AvgFinalExamScore' => 88, 'AvgAttendance' => 95],
                      ['GroupName' => 'Group Beta', 'TraineeCount' => 15, 'AvgFinalExamScore' => 75, 'AvgAttendance' => 88],
                  ];
                  foreach ($groups as $g): ?>
                    <tr>
                      <td class="px-4 py-4 whitespace-nowrap"><?= htmlspecialchars($g['GroupName']) ?></td>
                      <td class="px-4 py-4 whitespace-nowrap"><?= $g['TraineeCount'] ?></td>
                      <td class="px-4 py-4 whitespace-nowrap"><?= $g['AvgFinalExamScore'] ?>%</td>
                      <td class="px-4 py-4 whitespace-nowrap"><?= $g['AvgAttendance'] ?>%</td>
                      <!-- more cells if needed -->
                    </tr>
                  <?php endforeach; ?>
                </tbody>
              </table>
            </div>
          </main>
        </div>

        <?php include_once '../includes/footer.php'; ?>
        ```
    *   **Verification**:
        *   In the browser, load `dashboards/report_group_performance.php`.
        *   Verify that the header and sidebar render correctly.
        *   Confirm that the KPI cards (`chartAvgScore`, `chartAvgAttendance`, `chartAvgLGI`) display with the correct values and doughnut charts.
        *   Ensure the table of groups displays properly with Tailwind classes (e.g., `px-4 py-4 whitespace-nowrap`) and handles horizontal scrolling on small screens if content overflows.
        *   Check DevTools Console for no JavaScript errors. In the Network tab, confirm all assets load without 404s.
    *   **Testing**:
        *   Manually test by ensuring the PHP variables (`$avgScore`, `$avgAttendance`, `$avgLGI`, `$groups`) are correctly populated from `get_group_report_data.php` or dummy data. Verify that the charts and table data match the expected values.
        *   Resize the browser to confirm responsive behavior: cards should stack on mobile, and the table should scroll horizontally if needed.
        *   If "Export PDF" and "Email Report" buttons are present, confirm they still call `report-print.js` correctly (PDF generation and email form should appear).
    *   **Git Commit**: `feat: migrate report_group_performance.php to Tailwind + Alpine + Chart.js`

*   **Step 4.2: Migrate `dashboards/report_trainee_performance.php` (or `trainee_dashboard.php`)**
    *   **Action**:
        1.  Include `header.php` and `sidebar.php`.
        2.  Replace old Bootstrap structure with a similar Tailwind grid of KPI cards (e.g., PreTestScore, AvgQuizScore, FinalExamScore, LGI) using `kpi-card.php`.
        3.  Add a Tailwind-styled table for `$trainees` data.
        4.  Ensure Chart.js initialization in `assets/js/app.js` (or inline script) picks up `chartPreTest`, `chartQuizAvg`, `chartFinal`, `chartLGI`.
    *   **Verification & Testing**: Similar to Step 4.1, but verify with trainee-specific data. Ensure individual trainee metrics are correctly displayed in KPI cards and the table.
    *   **Git Commit**: `feat: migrate report_trainee_performance.php to Tailwind + Alpine + Chart.js`

*   **Step 4.3: Migrate `dashboards/report_attendance_summary.php`**
    *   **Action**:
        1.  Include `header.php` and `sidebar.php`.
        2.  Add a Chart.js bar chart (e.g., `chartAttendanceSummary`) that shows attendance percentage per group.
        3.  Implement a Tailwind-styled table for `$attendanceSummary` (columns: `GroupName`, `CourseName`, `PresentCount`, `AbsentCount`, `AttendancePercentage`).
    *   **Verification & Testing**: Verify the bar chart displays correct attendance percentages for each group. Ensure table data matches the database.
    *   **Git Commit**: `feat: migrate report_attendance_summary.php with tailwind layout and Chart.js bar chart`

*   **Step 4.4: Migrate `dashboards/attendance.php`**
    *   **Action**:
        1.  Replace any jQuery-driven inline editing with an Alpine-powered interface or a simple read-only table.
        2.  Display a table of `$trainees` with columns like `Name`, `PresentHours`, `AbsentHours`, `TakenSessions`, `AttendancePercentage`.
        3.  If editing is needed, wrap each row in an Alpine `x-data="{present: <?= $row['PresentHours'] ?>, absent: <?= $row['AbsentHours'] ?>}"` and use `<input x-model="present">` for editing.
        4.  Ensure form submission calls `submit_attendance.php` via standard POST.
    *   **Verification & Testing**: Confirm no jQuery errors in the console. Verify that attendance values update correctly on the frontend and are persisted to the database upon submission.
    *   **Git Commit**: `feat: migrate attendance.php to Tailwind + Alpine editable table`

*   **Step 4.5: Migrate `dashboards/coordinator_dashboard.php` and `dashboards/instructor_dashboard.php`**
    *   **Action**:
        1.  Similar to group/trainee reports but simpler—display quick stat cards and maybe a small chart.
        2.  Use the same `kpi-card.php` for any numeric summary.
        3.  If any JS-driven widgets exist, reimplement in Alpine (e.g., simplest toggle logic).
    *   **Verification & Testing**: Confirm role-based content shows correctly for each user. Verify that KPI cards and any other dynamic elements function as expected.
    *   **Git Commit**: `feat: migrate coordinator_dashboard.php to Tailwind + Alpine`
    *   **Git Commit**: `feat: migrate instructor_dashboard.php to Tailwind + Alpine`

### Phase 5: Finalization, Testing, & Documentation

**Objective**: Finalize the migration, perform comprehensive testing, and update documentation.

*   **Step 5.1: Write the “Verification Mechanism” for each page**
    *   **Action**: For each migrated page, specify which elements to check (chart correctness, table data, responsive breakpoints, no console errors, role-based link visibility). Include a set of “sample test cases.”
    *   **Example for `report_group_performance.php`**:
        *   **Verification Checklist**:
            *   Header and sidebar display correctly and are responsive.
            *   KPI cards for "Avg Score", "Avg Attendance", "Avg LGI" are present and show correct values.
            *   Doughnut charts within KPI cards render correctly with appropriate percentages.
            *   Groups table displays all expected columns (`Group Name`, `# Trainees`, `Avg Score`, `Avg Attendance`).
            *   Table data matches the values from the database.
            *   Table is horizontally scrollable on small screens.
            *   No JavaScript errors or warnings in the browser console.
            *   No 404 errors for CSS or JS assets in the Network tab.
            *   "Export PDF" button triggers PDF generation with correct layout and data.
            *   "Email Report" button opens the email modal and allows sending.
        *   **Sample Test Cases**:
            1.  **Data Accuracy**: Create two groups in the DB: "Group A" (Avg Score: 85%, Avg Attendance: 92%, Avg LGI: 70%) and "Group B" (Avg Score: 70%, Avg Attendance: 80%, Avg LGI: 50%). Load `report_group_performance.php`. Verify KPI cards and table rows reflect these exact values.
            2.  **Responsiveness**: Load the page on a desktop browser, then resize the window to simulate a mobile device (e.g., 375px width). Confirm KPI cards stack vertically and the groups table becomes horizontally scrollable.
            3.  **PDF Export**: Click "Export PDF". Open the generated PDF. Verify the layout, data, and presence of header/footer elements.
            4.  **Email Report**: Click "Email Report". Fill in dummy recipient/subject. Confirm the email modal appears and the form can be submitted (check server logs for email sending attempt if possible).
    *   **Git Commit**: `docs: add verification checklist and sample test cases for migrated pages`

*   **Step 5.2: Clean up & remove deprecated files**
    *   **Action**: Delete all old Sneat/Bootstrap CSS files under `/assets/css/` (excluding `custom.css` and `tailwind.css`) and any jQuery-dependent JS under `/assets/js/` (excluding `app.js` and `html2pdf` vendor files). Remove unused PHP includes that referenced Bootstrap classes.
    *   **Verification**: Run a global search for any remaining `class="btn btn-..."` or `$(...)` references in the codebase. Only instances within `html2pdf` or other retained third-party libraries should remain.
    *   **Testing**: In DevTools, confirm no 404 errors for removed files and no lingering console errors. The application should function entirely on the new stack.
    *   **Git Commit**: `chore: remove deprecated Bootstrap/Sneat assets and jQuery files`

*   **Step 5.3: Final code review & merge into `main`**
    *   **Action**: Create a Pull Request comparing `feature/tailwind-rebuild` to `main`. Review changes to ensure all migrated pages follow Tailwind best practices, no leftover Bootstrap classes, and Alpine logic is consistent (`x-data`, `x-show`). Merge the PR once approved.
    *   **Git**: Merge commit will be `merge: feature/tailwind-rebuild into main -- UI migration complete`

*   **Step 5.4: Post-Migration Smoke Testing & Performance Check**
    *   **Action**:
        1.  Clear any server and browser caches.
        2.  Perform a final QA checklist:
            *   Log in as each role (Admin, Instructor, Coordinator) and verify correct menu items appear.
            *   Navigate to every dashboard page and confirm each chart and table is accurate.
            *   Test PDF/email exports on each report page.
            *   Resize browser from 320px → 1440px and verify responsive layout (cards stack, tables scroll).
            *   Check DevTools for no errors/warnings.
            *   Verify API endpoints (AJAX calls) still function for “Add Trainee” or “Filter by Group” features.
    *   **Git Commit**: `test: add post-migration smoke tests and performance observations`

## IV. Git Workflow & Commit Guidelines

This section outlines the recommended Git workflow and commit message guidelines for the UI migration project.

### Initial Setup

1.  **Create Feature Branch**:
    ```bash
    git checkout main
    git pull origin main
    git checkout -b feature/tailwind-rebuild
    ```
2.  **Backup Documentation**:
    ```bash
    mkdir docs
    cp logs/Water\ Academy\ System\ Documentation.md docs/Original_WaterAcademy_System_Documentation.md
    git add docs/Original_WaterAcademy_System_Documentation.md
    git commit -m "docs: backup existing system documentation"
    ```

### Per-Step Commits

Each step outlined in the "Transfer Phases & Steps" section should correspond to a single, logical commit. Follow these guidelines for commit messages:

*   **Commit Message Format**: `type: subject`
    *   **`type`**:
        *   `feat`: A new feature (e.g., implementing a new component, migrating a page).
        *   `chore`: Routine tasks, maintenance, or non-functional changes (e.g., removing old assets, updating build scripts).
        *   `docs`: Documentation changes (e.g., updating guides, adding comments).
        *   `test`: Adding or updating tests or verification guidelines.
        *   `fix`: A bug fix (less common in a migration, but possible).
    *   **`subject`**: A concise, imperative statement (e.g., "implement Tailwind header", "remove old Bootstrap assets").

*   **Example Commits**:
    *   `chore: remove Sneat/Bootstrap asset references and vendor files`
    *   `feat: add Tailwind, Alpine.js, Chart.js references and custom.css placeholder`
    *   `feat: implement Tailwind/Alpine header.php with PHP guards and logo`
    *   `feat: add Alpine/Chart.js KPI card component partial kpi-card.php`
    *   `feat: migrate report_group_performance.php to Tailwind + Alpine + Chart.js`
    *   `docs: add verification checklist and sample test cases for migrated pages`

*   **Branch Protection**: Ensure branch protection rules are enabled on the remote repository, requiring at least one peer review before merging into `main`.

### Merging

1.  **Push Feature Branch**:
    ```bash
    git push origin feature/tailwind-rebuild
    ```
2.  **Create Pull Request (PR)**: Open a PR from `feature/tailwind-rebuild` to `main`.
3.  **Review & Address Comments**: Collaborate with reviewers, address any feedback or required changes.
4.  **Merge**: Once approved, merge the PR. Prefer a "Squash and Merge" strategy for a clean `main` history, or a standard merge commit depending on team policy.
    *   **Merge Commit Message Example**: `merge: feature/tailwind-rebuild into main -- UI migration complete`

### Post-Merge

*   **Tag Release**: Consider tagging a new release (e.g., `v2.0-ui-tailwind`) to mark the completion of the UI migration.
    ```bash
    git tag v2.0-ui-tailwind
    git push origin v2.0-ui-tailwind
    ```
*   **Update README.md**: Update the main `README.md` to reflect the new UI stack.
    ```markdown
    # Water Academy Visualizer

    This project now uses Tailwind CSS + Alpine.js + Chart.js for its frontend UI (as of v2.0).

    For detailed system documentation, refer to:
    - [Original System Documentation](docs/Original_WaterAcademy_System_Documentation.md)
    - [UI Transfer Guide](WaterAcademy_UI_TransferGuide.md)
